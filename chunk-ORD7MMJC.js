import{b as g,k as p}from"./chunk-O6YQIL4L.js";import{A as i,Q as r,Tb as a,U as u,Y as m,l as n,la as d,q as y}from"./chunk-3XB4H34J.js";var S=class l{constructor(e){this.api=e}basePath="/teacher/sentiment-analyses";analysisState=d({loading:!1,error:null,data:null});analysesListState=d({loading:!1,error:null,data:[]});analysis=a(()=>this.analysisState().data);analysisLoading=a(()=>this.analysisState().loading);analysisError=a(()=>this.analysisState().error);analysesList=a(()=>this.analysesListState().data);analysesListLoading=a(()=>this.analysesListState().loading);analysesListError=a(()=>this.analysesListState().error);hasAnalysis=a(()=>this.analysisState().data!==null);isAnalysisCompleted=a(()=>this.analysisState().data?.status==="COMPLETED");getById(e){return this.api.get(`${this.basePath}/${e}`)}getByQuiz(e,t){let s={quizId:e};return t&&(s.questionId=t),this.api.get(this.basePath,{params:s})}getByQuizAndQuestion(e,t){return this.getByQuiz(e,t).pipe(y(s=>s.length>0?s[0]:null))}analyze(e){let t={quizId:g(e.quizId),questionId:g(e.questionId)};return e.model&&(t.model=String(e.model)),this.api.post(this.basePath,t)}getAll(){return this.api.get(`${this.basePath}/all/analysis`)}loadAnalysis(e){this.analysisState.set({loading:!0,error:null,data:null}),this.getById(e).pipe(r(t=>{this.analysisState.set({loading:!1,error:null,data:t})}),i(t=>{let s=t?.error?.message||"Failed to load sentiment analysis";return this.analysisState.set({loading:!1,error:s,data:null}),n(null)})).subscribe()}loadAnalysesList(e,t){this.analysesListState.set({loading:!0,error:null,data:[]}),this.getByQuiz(e,t).pipe(r(s=>{this.analysesListState.set({loading:!1,error:null,data:s})}),i(s=>{let o=s?.error?.message||"Failed to load sentiment analyses";return this.analysesListState.set({loading:!1,error:o,data:[]}),n([])})).subscribe()}runAnalysis(e){return this.analysisState.set({loading:!0,error:null,data:null}),this.analyze(e).pipe(r(t=>{this.analysisState.set({loading:!1,error:null,data:t})}),i(t=>{let s=t?.error?.message||"Failed to run sentiment analysis";throw this.analysisState.set({loading:!1,error:s,data:null}),t}))}loadExistingAnalysis(e,t){this.analysisState.set({loading:!0,error:null,data:null}),this.getByQuizAndQuestion(e,t).pipe(r(s=>{this.analysisState.set({loading:!1,error:null,data:s})}),i(s=>{if(s?.status===404)return this.analysisState.set({loading:!1,error:null,data:null}),n(null);let o=s?.error?.message||"Failed to check for existing analysis";return this.analysisState.set({loading:!1,error:o,data:null}),n(null)})).subscribe()}clearAnalysis(){this.analysisState.set({loading:!1,error:null,data:null})}clearAnalysesList(){this.analysesListState.set({loading:!1,error:null,data:[]})}getSentimentLabel(e){return{POSITIVE:"Positive",NEUTRAL:"Neutral",NEGATIVE:"Negative",MIXED:"Mixed"}[e]||e}getSentimentClass(e){return{POSITIVE:"sentiment-positive",NEUTRAL:"sentiment-neutral",NEGATIVE:"sentiment-negative",MIXED:"sentiment-mixed"}[e]||""}formatConfidence(e){return`${Math.round(e*100)}%`}formatSentimentScore(e){return e===void 0?"N/A":`${Math.round((e+1)*50)}%`}static \u0275fac=function(t){return new(t||l)(m(p))};static \u0275prov=u({token:l,factory:l.\u0275fac,providedIn:"root"})};export{S as a};
