import{a as R,b as z}from"./chunk-II2EREQW.js";import{a as B}from"./chunk-TQBAXRVG.js";import{a as u}from"./chunk-G4B6EPNI.js";import{a as I}from"./chunk-MSJ3XUEL.js";import"./chunk-MD74L3HJ.js";import"./chunk-FWCO3CJY.js";import"./chunk-AO6LNOWB.js";import"./chunk-SJBCNNOS.js";import"./chunk-2WUHN5CQ.js";import"./chunk-MAWX5T35.js";import"./chunk-XGVRFAFZ.js";import"./chunk-4BWE2P25.js";import"./chunk-LUIYB3PI.js";import{a as S,c as L,d as D,h as U}from"./chunk-LM6INHLT.js";import{$a as p,F as b,Ka as _,Tb as P,Va as C,Wa as M,Xb as k,Z as a,ab as r,ba as f,bb as o,ca as h,cb as x,ha as y,jb as O,lb as s,nb as w,rc as T,xa as v,z as g,za as d}from"./chunk-3XB4H34J.js";function E(l,e){if(l&1){let i=O();r(0,"div",6),s("click",function(){f(i);let n=w();return h(n.closeMobile())}),o()}}var A=class l{router=a(D);authService=a(B);authStore=a(I);destroyRef=a(y);cdr=a(k);logoutLoading=!1;errorMessage="";session=P(()=>this.authStore.getSession());tabs=[{id:"dashboard",label:"Dashboard"},{id:"academic-years",label:"Academic Years"},{id:"semesters",label:"Semesters"},{id:"exam-types",label:"Exam Types"},{id:"teaching-units",label:"Teaching Units"},{id:"mini-admins",label:"Speciality Head"},{id:"ai-analytics",label:"AI Analytics"},{id:"sentiment-analysis",label:"Sentiment Analysis"}];activeTab="dashboard";constructor(){this.syncTabFromUrl(this.router.url),this.router.events.pipe(g(e=>e instanceof S),u(this.destroyRef)).subscribe(e=>this.syncTabFromUrl(e.urlAfterRedirects))}isCollapsed=!1;isMobile=window.innerWidth<=900;mobileOpen=!1;menuItems=[{id:"dashboard",label:"Dashboard",route:"/dean",icon:"dashboard"},{id:"academic-years",label:"Academic Years",route:"/dean/academic-years",icon:"calendar_month"},{id:"semesters",label:"Semesters",route:"/dean/semesters",icon:"school"},{id:"specialities",label:"Specialities",route:"/dean/specialities",icon:"badge"},{id:"exam-types",label:"Exam Types",route:"/dean/exam-types",icon:"assignment"},{id:"teaching-units",label:"Teaching Units",route:"/dean/teaching-units",icon:"menu_book"},{id:"mini-admins",label:"Speciality Head",route:"/dean/mini-admins",icon:"groups"},{id:"ai-analytics",label:"AI Analytics",route:"/dean/ai-analytics",icon:"insights"},{id:"sentiment-analysis",label:"Sentiment Analysis",route:"/dean/sentiment-analysis",icon:"psychology"}];get currentTitle(){return this.tabs.find(e=>e.id===this.activeTab)?.label??"Dashboard"}onResize(){this.isMobile=window.innerWidth<=900,this.isMobile||(this.mobileOpen=!1)}toggleCollapse(){this.isCollapsed=!this.isCollapsed;try{localStorage.setItem("dean.sidebar.collapsed",String(this.isCollapsed))}catch{}}toggleMobile(){this.mobileOpen=!this.mobileOpen}closeMobile(){this.isMobile&&(this.mobileOpen=!1)}syncTabFromUrl(e){e.includes("/dean/academic-years")?this.activeTab="academic-years":e.includes("/dean/semesters")?this.activeTab="semesters":e.includes("/dean/exam-types")?this.activeTab="exam-types":e.includes("/dean/teaching-units")?this.activeTab="teaching-units":e.includes("/dean/mini-admins")?this.activeTab="mini-admins":e.includes("/dean/ai-analytics")?this.activeTab="ai-analytics":e.includes("/dean/sentiment-analysis")?this.activeTab="sentiment-analysis":this.activeTab="dashboard"}onTabChange(e){let i=String(e);switch(this.activeTab=i,i){case"dashboard":this.router.navigateByUrl("/dean");break;case"academic-years":this.router.navigateByUrl("/dean/academic-years");break;case"semesters":this.router.navigateByUrl("/dean/semesters");break;case"exam-types":this.router.navigateByUrl("/dean/exam-types");break;case"teaching-units":this.router.navigateByUrl("/dean/teaching-units");break;case"mini-admins":this.router.navigateByUrl("/dean/mini-admins");break;case"ai-analytics":this.router.navigateByUrl("/dean/ai-analytics");break;case"sentiment-analysis":this.router.navigateByUrl("/dean/sentiment-analysis");break}}onLogout(){this.errorMessage="",this.logoutLoading=!0,this.authService.logout().pipe(u(this.destroyRef),b(()=>{this.logoutLoading=!1,this.cdr.markForCheck()})).subscribe({next:async()=>{await this.router.navigateByUrl("/login")},error:e=>{this.errorMessage=e instanceof Error?e.message:"Logout failed.",this.cdr.markForCheck(),this.router.navigateByUrl("/login")}})}ngOnInit(){let e=(()=>{try{return localStorage.getItem("dean.sidebar.collapsed")}catch{return null}})(),i=window.innerWidth;this.isMobile=i<=900,e==="true"||e==="false"?this.isCollapsed=e==="true":!this.isMobile&&i<=1200?this.isCollapsed=!0:this.isCollapsed=!1}static \u0275fac=function(i){return new(i||l)};static \u0275cmp=_({type:l,selectors:[["app-dean-layout"]],hostBindings:function(i,t){i&1&&s("resize",function(){return t.onResize()},v)},decls:7,vars:11,consts:[[1,"dean","layout"],["brandLink","/dean",3,"toggle","itemSelected","items","collapsed","isMobile","open"],[1,"main"],[3,"menuClick","logoutClick","title","isMobile","userName","userSurname","userRole","logoutLoading"],[1,"dean__content"],["aria-hidden","true",1,"overlay"],["aria-hidden","true",1,"overlay",3,"click"]],template:function(i,t){if(i&1&&(r(0,"div",0)(1,"app-sidebar",1),s("toggle",function(){return t.toggleCollapse()})("itemSelected",function(){return t.closeMobile()}),o(),r(2,"div",2)(3,"app-topbar",3),s("menuClick",function(){return t.toggleMobile()})("logoutClick",function(){return t.onLogout()}),o(),r(4,"main",4),x(5,"router-outlet"),o()(),C(6,E,1,0,"div",5),o()),i&2){let n,c,m;d(),p("items",t.menuItems)("collapsed",t.isCollapsed)("isMobile",t.isMobile)("open",t.mobileOpen),d(2),p("title",t.currentTitle)("isMobile",t.isMobile)("userName",(n=t.session())==null||n.user==null?null:n.user.name)("userSurname",(c=t.session())==null||c.user==null?null:c.user.surname)("userRole",(m=t.session())==null||m.user==null?null:m.user.role)("logoutLoading",t.logoutLoading),d(3),M(t.isMobile&&t.mobileOpen?6:-1)}},dependencies:[T,U,L,R,z],styles:[".dean[_ngcontent-%COMP%]{min-height:100vh;background:var(--surface-base);color:var(--text-primary);display:flex;flex-direction:column}.dean__header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:1rem;padding:1rem 1.25rem;border-bottom:1px solid var(--border-default)}.dean__header-left[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem;min-width:0}.dean__title[_ngcontent-%COMP%]{font-weight:700;font-size:1.1rem}.dean__subtitle[_ngcontent-%COMP%]{color:var(--text-tertiary);font-size:.9rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:60vw}.dean__nav[_ngcontent-%COMP%]{padding:.5rem 1.25rem;border-bottom:1px solid var(--border-default)}.dean__content[_ngcontent-%COMP%]{padding:1.25rem;flex:1}.layout[_ngcontent-%COMP%]{display:flex;min-height:100vh}.dean.layout[_ngcontent-%COMP%]{flex-direction:row}.sidebar[_ngcontent-%COMP%]{width:240px;background:var(--surface-raised);border-right:1px solid var(--border-default);color:var(--text-primary);display:flex;flex-direction:column;transition:width .2s ease,transform .2s ease;z-index:60}.sidebar.collapsed[_ngcontent-%COMP%]{width:72px}.sidebar-top[_ngcontent-%COMP%]{padding:1rem;display:flex;align-items:center;gap:.75rem}.brand[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;color:inherit;text-decoration:none}.brand-logo[_ngcontent-%COMP%]{width:36px;height:36px;display:inline-grid;place-items:center;border-radius:10px;background:linear-gradient(135deg,var(--primary-base),var(--secondary-base));color:#fff;font-weight:700}.brand-text[_ngcontent-%COMP%]{font-weight:700}.sidebar-nav[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;padding:.5rem;gap:.25rem}.nav-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.6rem .9rem;border-radius:10px;color:var(--text-primary);text-decoration:none;transition:background .15s ease,color .15s ease;position:relative}.nav-item[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:20px}.nav-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.nav-item[_ngcontent-%COMP%]:hover{background:var(--surface-raised);background:color-mix(in srgb,var(--surface-raised) 94%,#000 6%)}.nav-item.active[_ngcontent-%COMP%]{background:var(--surface-raised);background:color-mix(in srgb,var(--primary-base) 12%,var(--surface-raised) 88%);color:var(--text-primary)}.sidebar.collapsed[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%], .sidebar.collapsed[_ngcontent-%COMP%]   .brand-text[_ngcontent-%COMP%]{display:none}.sidebar.collapsed[_ngcontent-%COMP%]   .nav-item[data-tooltip][_ngcontent-%COMP%]:hover:after{content:attr(data-tooltip);position:absolute;left:100%;top:50%;transform:translateY(-50%);white-space:nowrap;background:var(--surface-raised);color:var(--text-primary);padding:.35rem .6rem;border-radius:8px;box-shadow:0 6px 18px #02061733;margin-left:8px;font-size:.85rem;border:1px solid var(--border-default)}.sidebar-footer[_ngcontent-%COMP%]{padding:.75rem;display:flex;justify-content:center}.collapse-btn[_ngcontent-%COMP%]{background:transparent;border:none;cursor:pointer;padding:.45rem;border-radius:8px}.main[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;min-width:0}.topbar[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:.75rem 1rem;gap:1rem;border-bottom:1px solid var(--border-default)}.topbar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.page-title[_ngcontent-%COMP%]{font-weight:700}.menu-btn[_ngcontent-%COMP%]{background:transparent;border:none;padding:.4rem;border-radius:8px}.overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#02061773;z-index:50}@media (max-width: 900px){.sidebar[_ngcontent-%COMP%]{position:fixed;left:0;top:0;bottom:0;transform:translate(-110%);width:260px}.sidebar.mobile-open[_ngcontent-%COMP%]{transform:translate(0)}.sidebar.collapsed[_ngcontent-%COMP%]{width:260px}.main[_ngcontent-%COMP%]{margin-left:0}}@media (min-width: 901px){.main[_ngcontent-%COMP%]{margin-left:0}}"]})};export{A as DeanLayout};
