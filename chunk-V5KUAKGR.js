import{a as H}from"./chunk-WPWJA746.js";import"./chunk-TEBYAPM2.js";import{a as j,f as R,h as Y,l as J,o as U,t as G}from"./chunk-UUU7BI2K.js";import{c as V,d as N,e as k,f as D,g as L,l as W,n as A}from"./chunk-XIAE3S6L.js";import{a as Q,b as B}from"./chunk-W67SSUM4.js";import"./chunk-23TWDL4C.js";import{c as T,g as I}from"./chunk-5XPIWXNK.js";import{$a as p,Ab as q,Db as g,Eb as C,Fb as _,Ka as O,Sb as S,Va as x,Wa as h,Wb as E,Z as M,a as w,ab as t,ba as m,bb as i,ca as u,cb as y,jb as b,la as v,lb as f,nb as d,nc as F,p as z,yb as o,za as c,zb as P}from"./chunk-XVADYIPR.js";function Z(l,r){l&1&&(t(0,"div",11),y(1,"ui-spinner",14),t(2,"p"),o(3,"Loading courses..."),i()())}function $(l,r){if(l&1){let e=b();t(0,"ui-alert",12)(1,"mat-icon",15),o(2,"error"),i(),o(3),t(4,"ui-button",16),f("clicked",function(){m(e);let n=d();return u(n.loadCourses())}),o(5," Retry "),i()()}if(l&2){let e=d();c(3),q(" ",e.errorMessage()," ")}}function ee(l,r){if(l&1&&(t(0,"div",21)(1,"mat-icon"),o(2,"info"),i(),t(3,"span"),o(4),i()()),l&2){let e=d(2);c(4),P(e.selectedCourseInfo())}}function te(l,r){if(l&1){let e=b();t(0,"ui-card",13)(1,"form",17),f("ngSubmit",function(){m(e);let n=d();return u(n.nextStep())}),t(2,"div",18)(3,"h3"),o(4,"Select Course"),i(),t(5,"p",19),o(6,"Choose the course for this quiz. All students enrolled in this course will be automatically invited."),i(),t(7,"ui-select",20),_("ngModelChange",function(n){m(e);let s=d();return C(s.quizForm.courseId,n)||(s.quizForm.courseId=n),u(n)}),i(),x(8,ee,5,1,"div",21),i(),t(9,"div",18)(10,"h3"),o(11,"Quiz Configuration"),i(),t(12,"div",22)(13,"ui-select",23),_("ngModelChange",function(n){m(e);let s=d();return C(s.quizForm.type,n)||(s.quizForm.type=n),u(n)}),i(),t(14,"ui-input",24),_("ngModelChange",function(n){m(e);let s=d();return C(s.quizForm.lectures,n)||(s.quizForm.lectures=n),u(n)}),i()()(),t(15,"div",18)(16,"h3"),o(17,"Schedule"),i(),t(18,"p",19),o(19,"Set when the quiz will be available and how long students have to complete it."),i(),t(20,"div",22)(21,"ui-input",25),_("ngModelChange",function(n){m(e);let s=d();return C(s.quizForm.date,n)||(s.quizForm.date=n),u(n)}),i(),t(22,"ui-input",26),_("ngModelChange",function(n){m(e);let s=d();return C(s.quizForm.durationMinutes,n)||(s.quizForm.durationMinutes=n),u(n)}),i()()(),t(23,"div",27)(24,"ui-button",28),f("clicked",function(){m(e);let n=d();return u(n.goBack())}),t(25,"mat-icon",29),o(26,"arrow_back"),i(),o(27," Cancel "),i(),t(28,"ui-button",30),f("clicked",function(){m(e);let n=d();return u(n.nextStep())}),o(29," Next: Add Questions "),t(30,"mat-icon",31),o(31,"arrow_forward"),i()()()()()}if(l&2){let e=d();c(7),p("options",e.courseOptions())("required",!0),g("ngModel",e.quizForm.courseId),c(),h(e.selectedCourseInfo()?8:-1),c(5),p("options",e.quizTypeOptions)("required",!0),g("ngModel",e.quizForm.type),c(),p("required",!0)("min",1),g("ngModel",e.quizForm.lectures),c(7),p("required",!0),g("ngModel",e.quizForm.date),c(),p("required",!0)("min",1),g("ngModel",e.quizForm.durationMinutes),c(6),p("disabled",!e.isFormValid())}}var K=class l{teacherApi=M(H);router=M(T);cdr=M(E);isLoading=v(!1);errorMessage=v("");courses=v([]);quizForm={courseId:"",type:"",lectures:1,date:"",durationMinutes:60};quizTypeOptions=[{value:"CA",label:"Continuous Assessment (CA)"},{value:"MEDIAN",label:"Midterm Exam"},{value:"FINAL",label:"Final Exam"},{value:"MOCK",label:"Mock Test / Practice"}];courseOptions=S(()=>this.courses().map(r=>({value:r.id,label:this.getCourseLabel(r)})));selectedCourseInfo=S(()=>{if(!this.quizForm.courseId)return"";let r=this.courses().find(X=>X.id===this.quizForm.courseId);if(!r)return"";let e=r.classAcademicYear?.class?.name??"",a=r.classAcademicYear?.class?.level??r.level??"",n=r.credits,s=[];return e&&s.push(`Class: ${e}`),a&&s.push(`Level: ${a}`),n&&s.push(`${n} credits`),s.join(" \u2022 ")});async ngOnInit(){this.loadSavedData(),await this.loadCourses()}loadSavedData(){let r=sessionStorage.getItem("examFormStep1");if(r)try{let e=JSON.parse(r);this.quizForm=w(w({},this.quizForm),e)}catch{}}async loadCourses(){this.isLoading.set(!0),this.errorMessage.set("");try{let r=await z(this.teacherApi.getMyCourses());this.courses.set(r)}catch(r){this.errorMessage.set(r instanceof Error?r.message:"Failed to load courses. Please try again.")}finally{this.isLoading.set(!1),this.cdr.markForCheck()}}getCourseLabel(r){let e=r.teachingUnit?.name??"Unknown Subject",a=r.classAcademicYear?.class?.name??"";return a?`${e} \u2014 ${a}`:e}isFormValid(){return!!(this.quizForm.courseId&&this.quizForm.type&&this.quizForm.date&&this.quizForm.durationMinutes>0&&this.quizForm.lectures>0)}goBack(){this.router.navigate(["/teacher/exam-manager"])}nextStep(){if(!this.isFormValid())return;let r={courseId:String(this.quizForm.courseId),type:String(this.quizForm.type),lectures:Number(this.quizForm.lectures),date:String(this.quizForm.date),durationMinutes:Number(this.quizForm.durationMinutes)};sessionStorage.setItem("examFormStep1",JSON.stringify(r)),this.router.navigate(["/teacher/create-exam/step2"])}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=O({type:l,selectors:[["app-teacher-create-exam"]],decls:37,vars:3,consts:[[1,"create-exam"],[1,"page-header"],["variant","elevated",1,"stepper-card"],[1,"progress-stepper"],[1,"step","active"],[1,"step-number"],[1,"step-info"],[1,"step-title"],[1,"step-desc"],[1,"step-connector"],[1,"step"],[1,"loading-state"],["variant","filled","color","danger"],["variant","elevated","title","Quiz Details"],["size","lg"],["slot","icon"],["slot","action","variant","outline","color","danger","size","sm",3,"clicked"],[1,"quiz-form",3,"ngSubmit"],[1,"form-section"],[1,"section-hint"],["label","Course","placeholder","Select a course","name","courseId",3,"ngModelChange","options","required","ngModel"],[1,"course-preview"],[1,"form-row"],["label","Quiz Type","placeholder","Select quiz type","name","type",3,"ngModelChange","options","required","ngModel"],["type","number","label","Number of Lectures Covered","placeholder","e.g., 3","name","lectures","helperText","How many lectures does this quiz cover?",3,"ngModelChange","required","min","ngModel"],["type","datetime-local","label","Quiz Date & Time","name","date","helperText","When the quiz becomes available",3,"ngModelChange","required","ngModel"],["type","number","label","Duration (minutes)","placeholder","60","name","durationMinutes","helperText","Time limit for completion",3,"ngModelChange","required","min","ngModel"],[1,"form-actions"],["variant","outline","color","neutral",3,"clicked"],["slot","icon-left"],["variant","solid","color","primary",3,"clicked","disabled"],["slot","icon-right"]],template:function(e,a){e&1&&(t(0,"div",0)(1,"div",1)(2,"h1"),o(3,"Create New Quiz"),i(),t(4,"p"),o(5,"Set up your quiz details. Students will be automatically invited based on the selected course."),i()(),t(6,"ui-card",2)(7,"div",3)(8,"div",4)(9,"div",5),o(10,"1"),i(),t(11,"div",6)(12,"span",7),o(13,"Quiz Details"),i(),t(14,"span",8),o(15,"Course, type & schedule"),i()()(),y(16,"div",9),t(17,"div",10)(18,"div",5),o(19,"2"),i(),t(20,"div",6)(21,"span",7),o(22,"Add Questions"),i(),t(23,"span",8),o(24,"Build your quiz"),i()()(),y(25,"div",9),t(26,"div",10)(27,"div",5),o(28,"3"),i(),t(29,"div",6)(30,"span",7),o(31,"Review & Publish"),i(),t(32,"span",8),o(33,"Final review"),i()()()()(),x(34,Z,4,0,"div",11),x(35,$,6,1,"ui-alert",12),x(36,te,32,16,"ui-card",13),i()),e&2&&(c(34),h(a.isLoading()?34:-1),c(),h(a.errorMessage()?35:-1),c(),h(!a.isLoading()&&!a.errorMessage()?36:-1))},dependencies:[F,B,Q,I,A,L,V,N,W,D,k,J,j,R,Y,G,U],styles:[".create-exam[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:1.5rem}.page-header[_ngcontent-%COMP%]{margin-bottom:1.5rem}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:600;margin-bottom:.5rem;color:var(--color-text-primary)}.page-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--color-text-secondary);font-size:.938rem}.stepper-card[_ngcontent-%COMP%]{margin-bottom:1.5rem}.progress-stepper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:1rem 0}@media (max-width: 640px){.progress-stepper[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}}.step[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.step[_ngcontent-%COMP%]   .step-number[_ngcontent-%COMP%]{width:2.25rem;height:2.25rem;border-radius:50%;background:var(--color-background-muted);color:var(--color-text-secondary);display:flex;align-items:center;justify-content:center;font-weight:600;font-size:.938rem;transition:all .2s ease}.step.active[_ngcontent-%COMP%]   .step-number[_ngcontent-%COMP%]{background:var(--color-primary-600);color:#fff}.step.completed[_ngcontent-%COMP%]   .step-number[_ngcontent-%COMP%]{background:var(--color-success-600);color:#fff}.step[_ngcontent-%COMP%]   .step-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}.step[_ngcontent-%COMP%]   .step-title[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:var(--color-text-primary)}.step.active[_ngcontent-%COMP%]   .step-title[_ngcontent-%COMP%]{color:var(--color-primary-600);font-weight:600}.step[_ngcontent-%COMP%]   .step-desc[_ngcontent-%COMP%]{font-size:.75rem;color:var(--color-text-tertiary)}.step-connector[_ngcontent-%COMP%]{flex:1;height:2px;background:var(--color-border-default);margin:0 1.5rem;max-width:80px}@media (max-width: 640px){.step-connector[_ngcontent-%COMP%]{display:none}}.loading-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4rem 2rem;color:var(--color-text-secondary)}.loading-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:1rem}.quiz-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.form-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;margin-bottom:.5rem;color:var(--color-text-primary)}.form-section[_ngcontent-%COMP%]   .section-hint[_ngcontent-%COMP%]{font-size:.875rem;color:var(--color-text-secondary);margin-bottom:1rem}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:1rem}.course-preview[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-top:.75rem;padding:.75rem 1rem;background:var(--color-primary-50);border:1px solid var(--color-primary-200);border-radius:8px;font-size:.875rem;color:var(--color-primary-700)}.course-preview[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.25rem;width:1.25rem;height:1.25rem}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:1.5rem;border-top:1px solid var(--color-border-subtle)}@media (max-width: 480px){.form-actions[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}.form-actions[_ngcontent-%COMP%]   ui-button[_ngcontent-%COMP%]{width:100%}}[_nghost-%COMP%]     ui-card{margin-bottom:1.5rem}[_nghost-%COMP%]     .card__body{padding:1.5rem}"]})};export{K as TeacherCreateExam};
