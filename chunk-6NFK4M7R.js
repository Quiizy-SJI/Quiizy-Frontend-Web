import{a as D,b as P}from"./chunk-QOG2ZMGW.js";import{a as U}from"./chunk-XJDHSKTD.js";import{a as h}from"./chunk-P4VJLCHZ.js";import{a as I}from"./chunk-OQMWVOAO.js";import"./chunk-LSE4QE4L.js";import"./chunk-ZPZWYV2O.js";import"./chunk-DX4RU2C5.js";import"./chunk-C546SSYU.js";import"./chunk-KSJF27MU.js";import"./chunk-3OLBZRES.js";import"./chunk-YL2QS7YU.js";import"./chunk-HQOA22C6.js";import{a as x,c as B,d as R,h as E}from"./chunk-3WAO3F22.js";import{$a as m,F as p,Ka as _,Tb as S,Va as C,Wa as T,Xb as L,Z as o,ab as r,ba as g,bb as n,ca as v,cb as M,ha as f,jb as k,lb as s,nb as w,rc as O,xa as y,z as b,za as c}from"./chunk-T26DWB6S.js";function z(l,e){if(l&1){let i=k();r(0,"div",6),s("click",function(){g(i);let a=w();return v(a.closeMobile())}),n()}}var q=class l{router=o(R);authService=o(U);authStore=o(I);destroyRef=o(f);cdr=o(L);logoutLoading=!1;errorMessage="";session=S(()=>this.authStore.getSession());tabs=[{id:"dashboard",label:"Dashboard"},{id:"exam-manager",label:"Exam Manager"},{id:"sentiment-review",label:"Sentiment Analysis"},{id:"question-bank",label:"Question Bank"},{id:"statistics",label:"Statistics"},{id:"create-exam",label:"Create Exam"}];activeTab="dashboard";constructor(){this.syncTabFromUrl(this.router.url),this.router.events.pipe(b(e=>e instanceof x),h(this.destroyRef)).subscribe(e=>this.syncTabFromUrl(e.urlAfterRedirects))}isCollapsed=!1;isMobile=window.innerWidth<=900;mobileOpen=!1;menuItems=[{id:"dashboard",label:"Dashboard",route:"/teacher",icon:"dashboard"},{id:"exam-manager",label:"Exam Manager",route:"/teacher/exam-manager",icon:"assignment"},{id:"sentiment-review",label:"Sentiment Analysis",route:"/teacher/sentiment-review",icon:"psychology"},{id:"question-bank",label:"Question Bank",route:"/teacher/question-bank",icon:"quiz"},{id:"statistics",label:"Statistics",route:"/teacher/statistics",icon:"analytics"},{id:"create-exam",label:"Create Exam",route:"/teacher/create-exam",icon:"add_circle"}];get currentTitle(){return this.tabs.find(e=>e.id===this.activeTab)?.label??"Dashboard"}onResize(){this.isMobile=window.innerWidth<=900,this.isMobile||(this.mobileOpen=!1)}toggleCollapse(){this.isCollapsed=!this.isCollapsed;try{localStorage.setItem("teacher.sidebar.collapsed",String(this.isCollapsed))}catch{}}toggleMobile(){this.mobileOpen=!this.mobileOpen}closeMobile(){this.isMobile&&(this.mobileOpen=!1)}syncTabFromUrl(e){e.includes("/teacher/exam-manager")?this.activeTab="exam-manager":e.includes("/teacher/sentiment-review")?this.activeTab="sentiment-review":e.includes("/teacher/question-bank")?this.activeTab="question-bank":e.includes("/teacher/statistics")?this.activeTab="statistics":e.includes("/teacher/create-exam")?this.activeTab="create-exam":this.activeTab="dashboard"}onTabChange(e){let i=String(e);switch(this.activeTab=i,i){case"dashboard":this.router.navigateByUrl("/teacher");break;case"exam-manager":this.router.navigateByUrl("/teacher/exam-manager");break;case"sentiment-review":this.router.navigateByUrl("/teacher/sentiment-review");break;case"question-bank":this.router.navigateByUrl("/teacher/question-bank");break;case"statistics":this.router.navigateByUrl("/teacher/statistics");break;case"create-exam":this.router.navigateByUrl("/teacher/create-exam");break}}onLogout(){this.errorMessage="",this.logoutLoading=!0,this.authService.logout().pipe(h(this.destroyRef),p(()=>{this.logoutLoading=!1,this.cdr.markForCheck()})).subscribe({next:async()=>{await this.router.navigateByUrl("/login")},error:e=>{this.errorMessage=e instanceof Error?e.message:"Logout failed.",this.cdr.markForCheck(),this.router.navigateByUrl("/login")}})}ngOnInit(){let e=(()=>{try{return localStorage.getItem("teacher.sidebar.collapsed")}catch{return null}})(),i=window.innerWidth;this.isMobile=i<=900,e==="true"||e==="false"?this.isCollapsed=e==="true":!this.isMobile&&i<=1200?this.isCollapsed=!0:this.isCollapsed=!1}static \u0275fac=function(i){return new(i||l)};static \u0275cmp=_({type:l,selectors:[["app-teacher-layout"]],hostBindings:function(i,t){i&1&&s("resize",function(){return t.onResize()},y)},decls:7,vars:11,consts:[[1,"teacher","layout"],["brandLink","/teacher",3,"toggle","itemSelected","items","collapsed","isMobile","open"],[1,"main"],[3,"menuClick","logoutClick","title","isMobile","userName","userSurname","userRole","logoutLoading"],[1,"teacher__content"],["aria-hidden","true",1,"overlay"],["aria-hidden","true",1,"overlay",3,"click"]],template:function(i,t){if(i&1&&(r(0,"div",0)(1,"app-sidebar",1),s("toggle",function(){return t.toggleCollapse()})("itemSelected",function(){return t.closeMobile()}),n(),r(2,"div",2)(3,"app-topbar",3),s("menuClick",function(){return t.toggleMobile()})("logoutClick",function(){return t.onLogout()}),n(),r(4,"main",4),M(5,"router-outlet"),n()(),C(6,z,1,0,"div",5),n()),i&2){let a,d,u;c(),m("items",t.menuItems)("collapsed",t.isCollapsed)("isMobile",t.isMobile)("open",t.mobileOpen),c(2),m("title",t.currentTitle)("isMobile",t.isMobile)("userName",(a=t.session())==null||a.user==null?null:a.user.name)("userSurname",(d=t.session())==null||d.user==null?null:d.user.surname)("userRole",(u=t.session())==null||u.user==null?null:u.user.role)("logoutLoading",t.logoutLoading),c(3),T(t.isMobile&&t.mobileOpen?6:-1)}},dependencies:[O,E,B,D,P],styles:[".teacher.layout[_ngcontent-%COMP%]{display:flex;height:100vh;overflow:hidden}.teacher.layout[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;min-width:0}.teacher.layout[_ngcontent-%COMP%]   .teacher__content[_ngcontent-%COMP%]{flex:1;overflow:auto;padding:1.5rem;background:var(--color-background-subtle)}@media (max-width: 768px){.teacher.layout[_ngcontent-%COMP%]   .teacher__content[_ngcontent-%COMP%]{padding:1rem}}.teacher.layout[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;z-index:40}"]})};export{q as TeacherLayout};
